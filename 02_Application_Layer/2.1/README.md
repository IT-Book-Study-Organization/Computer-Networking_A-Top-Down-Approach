# Chapter 2
##### Application Layer

### 2.1 네트워크 애플리케이션의 원칙
- 네트워크 애플리케이션 개발의 핵심은 서로 다른 종단 시스템에서 실행되고 네트워크를 통해 통신하는 프로그램을 작성하는 것
- 예를들면 웹에서 웹 서버 호스트의 웹 서버 프로그램과 사용자 호스트의 브라우저 프로그램 간의 통신
- 따라서 응용 계층 개발자(일반적인 개발자 웹이나 서버 개발자)는 C,Java로 작성해도 되고 네트워크 코어에 대한 신경은 아예 안써도 됨.

#### 2.1.1 네트워크 애플리케이션 아키텍쳐
- 애플리케이션 아키텍쳐과 네트워크 아키텍쳐와 다르다.
- 애플리케이션 개발자는 네트워크 코어에 대해서 신경쓰지 않기 때문에 네트워크 아키텍쳐는 고정 되어 있다고 가정
- 따라서 애플리케이션은 두 가지 아키텍쳐 중 선택하면 되는데 애플리케이션 아키텍쳐에서는 "클라이언트-서버", "P2P" 아키텍쳐가 있음.

##### 클라이언트-서버 아키텍쳐
  ![image](https://github.com/user-attachments/assets/2f935b18-2d25-4b9f-aaf1-e046dd693ab7)
  (출처: https://velog.io/@dnflekf2748/%ED%81%B4%EB%9D%BC%EC%9D%B4%EC%96%B8%ED%8A%B8-%EC%84%9C%EB%B2%84-%EC%95%84%ED%82%A4%ED%85%8D%EC%B3%90)
- 항상 켜져 있는 호스트인 서버가 여러 다른 호스트(클라이언트)로부터의 요청을 받음.
- 웹 서버는 특정 객체에 대한 요청을 받으면 클라이언트 호스트에서 전송함. 이걸 응답이라고 함.
- 클라이언트는 서버를 매개해서 통신을 함(아래 그림과 같음)
  ![image](https://github.com/user-attachments/assets/ecc16a0c-2e9b-41d4-9359-3f59ad34f262)
  (출처: https://www.etri.re.kr/webzine/20230825/sub01.html)
- 서버 주소는 항상 고정되어 있어서 클라이언트는 서버의 IP주소에 패킷을 전송하여 항상 서버에 연락가능.
- 단일 서버로 버거우면 스케일 아웃을 통해 서버를 확장하기도 함.(아래 그림과 같음)
  ![image](https://github.com/user-attachments/assets/ce95f817-94b0-4321-9fb6-def170329c99)
  (출처: https://velog.io/@zzanggoon8/Part-6.-%EB%AA%A8%EB%93%A0-%EA%B2%83%EC%9D%B4-HTTPHTTP-%EA%B8%B0%EB%B3%B8)

##### P2P(피어 투 피어) 아키텍쳐
  ![image](https://github.com/user-attachments/assets/a22a657a-11b9-418b-8d9c-a4255e77aa66)
  (출처: https://www.researchgate.net/figure/Architecture-of-C-S-and-P2P_fig1_238638509)
- 데이터 센터에 있는 전용서버에 대한 의존도가 없음.
- 호스트 쌍 간의 직접 통신을 이용
- 자체 확장성이 좋고(서버가 없기 떄문에)
- 비용 효율적임
- 하지만 분산 구조 때문에 보안이나 성능 및 신뢰성 문제에 까다로움
- 우리가 익히 알고있는 토렌트나 블록체인은 이 방식을 따름

#### 2.1.2 프로세스 간의 통신
- 프로그램이 아닌 프로세스가 통신함
- 종단 시스템 내에서 실행중인 프로그램으로 이해하면 됨
- 프로세스 간 통신에서는 같은 호스트 내에서 통신과 다른 호스트에서 실행되는 프로세스 간의 통신이 있는데 이책에서는 다른 호스트에서 실행되는 프로세스 간의 통신이 있음
- 같은 호스트에서 통신은 아래와 같은데 더 궁금하신 분은 프로세스 간 통신 키워드로 검색하시면 알 수 있음.
  ![image](https://github.com/user-attachments/assets/eb41aee0-a6c3-4fad-bfa6-8b1eaa0a2ebc)
  (출처: https://dar0m.tistory.com/233)
  ##### 프로세스와 컴퓨터 네트워크 간의 인터페이스
  - 대부분의 애플리케이션은 서로 통신하는 프로세스 쌍으로 구성됨.
  - 두 프로세스가 서로 전송하기 위해선 소켓이라는 인터페이스를 통해 전송하는데 프로세스가 집이라면 소켓은 문이라고 생각할 수 있음.
  - 메시지를 보낼 때 문을 열고 메시지를 문 밖으로 밀어낸다 이렇게 생각하면 됨.
  - ![image](https://github.com/user-attachments/assets/26586414-3dd1-4a96-b0b5-3fa8cb7b95e3)
 
  ##### 프로세스 주소 지정
  - 호스트가 아파트, process가 아파트에 있는 우리집(누군가가 살고있는 집)이라면
  - 호스트는 Ip 주소로 찾고 그 호스트에서 port 번호를 통해 프로세스를 찾는 꼴
  - 다시 말해 호스트에서 프로세스가 실행되고 있는 것 이므로 한 호스트 안에 여러 프로세스가 실행되고 있기 때문에 port도 구분한다고 생각하면 됨.
  - 이를테면 웹 서버는 항상 80 port 로 고정

#### 2.1.3 애플리케이션에 제공되는 전송 서비스
- 전송 프로토콜을 선택해야 하는데 전송 프로토콜은 집 밖으로 물건을 내 놓고 그 물건을 우체국 택배로 보낼 지, 직접 가서 직거래를 할지 이런 걸 정하는 것임.
- 두 방법이 각자 장단점이 있듯이 전송 프로토콜도 그러함.
  ##### 신뢰할 수 있는 데이터 전송
  - 전자 메일이나 파일 전송, 금융 애플리케이션은 데이터 손실이 치명적임. 
  - 프로토콜이 이러한 데이터 전송 보장 서비스를 제공해야함. 이를 신뢰할 수 있는 데이터 전송이라고 함.
  - 우리가 택배를 보내면 알아서 잘 보내지겠지 라고 생각하는 것과 같다.
  - 그런데 신뢰성이 굳이 보장되지 않아도 좋은 경우가 있는데 스트리밍 서비스 이를테면 유튜브같은 동영상 플렛폼이 그렇다. 1초 당 100 프레임 중 3개의 프레임이 빠져도 알아 차릴 수 없듯이 별로 상관 안씀. 장애라고 취급도 안한다.
 
  ##### 처리량
  - 두 프로세스간 통신에서 송신 프로세스가 수신 프로세스에 비트를 전달할 수 있는 속도임
  - 처리량은 변동적이기 때문에 특정 전송 속도 이상을 보장해야 할 때가 있다.
  - 예를들면 우리가 영화 같은 거 다운 받을 라고 할 때 되게 느리게 받아질 때가 있는데 그 때가 최소 전송속도가 적어서 그럼(1초당 보내는 양이 적어서)
  - 따라서 대용량 파일을 전송하는 서비스 유튜브 같은곳 에서는 이러한 최소 처리량을 보장해야하는 프로토콜을 선택해야한다.

  ##### 타이밍
  - 송신자가 소켓에 넣은 모든 비트가 1초 미만으로 도착해야한다는 보장이 필요할 수 도있는데 이를 타이밍이라고 한다.
  -  m/s 도 표현하는데 실시간 게임, 화상 회의, 가상 환경 이럴 때 중요한다.
  - 예를들면 우리가 롤을 하고 있는데 자꾸 20m/s 이상 올라가면 자꾸 렉이 걸려서 게임이 하기 싫어지는 것과 같은데 우리가 자주하는 핑이 튄다 말과 라는 개념이 유사하다
  ##### 보안
  - 보안도 중요한데 송신 프로세스가 전송하는 모든 데이터를 암호화 해서 보낼 때가 있다.

#### 2.1.4 인터넷에서 제공하는 전송 서비스
- 인터넷에서는 그 프로토콜을 두 가지 선택했는데 바로 TCP, UDP다.
  ##### TCP 서비스
  - TCP는 두가지로 요약할 수 있다. 연결 지향 서비스, 신뢰할 수 있는 데이터 전송 서비스
    ###### 연결지향 서비스
    - 메시지 보내기 전에 나 보낸다? 라고 질문하는 것이다. 이걸 핸드셰이킹이라고 하는데 처음만나서 악수하고 할말하는 거랑 같다.
    - 이걸 하면 좋은 이유는 먼저 예고를 했기 때문에 송신자 입장에선 패킷의 폭주를 대비할 수 있다는 말이다.
    - 그리고 말을 하다면 연결을 끊는다.
      
    ###### 신뢰할 수 있는 데이터 전송 서비스
    - TCP는 모든 데이터를 오류없이 보내는데 이걸 또 순서를 지켜서 전송한다.

  ##### UDP 서비스
  - UDP는 최소한의 서비스만 제공한다. 핸드쉐이킹도 없고 신뢰할 수 없는 데이터를 전송하고 내가 보냈을 때 수신에게 갈 것이라는 보장도 하지 않는다.
  - 또 순서도 바뀔 수 있다.
  - 역설적으로 이 때문에 TCP에 비해 큰 장점이 있는데 아무것도 하는게 없기 때문에 경량화 되어서 빠르고 많이 전송할 수 있따는 것이다.
 ![image](https://github.com/user-attachments/assets/f4b30d8c-d100-46a2-95c8-e825b0f7b6c6)
(출처: https://shjz.tistory.com/98)
  ##### 인터넷 프로토콜에서 제공하지 않는 서비스
  - 신뢰성이랑 보안은 위에 보았듯이 제공한다.
  - 그런데 타이밍과 처리량은 제공안함.

#### 2.1.5 애플리케이션 계층 프로토콜
- 전송 프로토콜이 보내는 방식으 정의한다면 애플리케이션 프로토콜은 언제 전송할 지 내용물은 뭘지를 정의한다.
- 교환되는 메시지의 유형, 다양한 메시지의 유형의 구문, 필드의 의미, 프로세스가 메시지를 언제, 어떻게 전송하고응답하는지에 대한 규칙

#### 2.1.6 이 책에서 다루는 네트워크 애플리케이션
- 이 책에서는 소수의 애플리케이션에 초점을 맞출 건데 웹, 전자메일, 디렉토리 서비스, 비디오 스트리밍 및 P2P 애플리케이션의 다섯 가지 중요한 애플리케이션에 대해 노의함
- 웹에 대해 먼저 논의 할것임.
  
