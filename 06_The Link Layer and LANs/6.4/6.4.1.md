## **6.4 스위칭된 로컬 영역 네트워크(Switched Local Area Networks)**

스위칭된 로컬 네트워크(Switched LAN)는 **링크 계층(Link Layer)에서 동작하는 네트워크**로, **네트워크 계층 데이터그램이 아닌 링크 계층 프레임을 스위칭**합니다.  

- **네트워크 계층 주소(IP 주소)를 인식하지 않으며**, OSPF 같은 라우팅 알고리즘을 사용하지 않습니다.  
- **링크 계층 주소(MAC 주소)를 사용하여 프레임을 전달**합니다.  

이 절에서는 다음과 같은 내용을 다룹니다.  

1. **링크 계층 주소 지정과 ARP**  
2. **이더넷(Ethernet) 프로토콜**  
3. **링크 계층 스위치의 동작 방식**  
4. **대규모 LAN 구축 방식**  

---

## **6.4.1 링크 계층 주소 지정(Link-Layer Addressing)과 ARP**

### **MAC 주소(MAC Addresses)**  

네트워크에서 사용되는 **링크 계층 주소**는 다음과 같이 불립니다.  
- **LAN 주소(LAN address)**  
- **물리 주소(Physical address)**  
- **MAC 주소(Media Access Control address)**  

이 중 **MAC 주소**라는 용어가 가장 널리 사용됩니다.  

#### **MAC 주소의 특징**
- **MAC 주소는 네트워크 인터페이스(어댑터)에 할당**되며, 하나의 호스트 또는 라우터가 여러 개의 네트워크 인터페이스를 가지면 각 인터페이스는 **고유한 MAC 주소**를 가집니다.  
- **링크 계층 스위치는 MAC 주소를 가지지 않습니다.**  
- **MAC 주소의 길이는 6바이트(48비트)**이며, **16진수 표기법**으로 표현됩니다.  
  - 예: `49-BD-D2-C7-56-2A`  
- **MAC 주소는 원래 변경할 수 없는 영구적인 값**이지만, 현재는 소프트웨어를 통해 변경할 수도 있습니다.  

#### **MAC 주소의 글로벌 유일성(Global Uniqueness)**
MAC 주소는 전 세계적으로 고유해야 합니다. 이를 보장하기 위해 **IEEE(국제전기전자기술자협회)**가 MAC 주소를 관리합니다.  

- 제조업체는 IEEE에 일정 비용을 지불하고 MAC 주소 공간을 할당받습니다.  
- **MAC 주소의 앞 24비트는 특정 제조업체에 할당**, 나머지 24비트는 제조업체가 고유하게 부여합니다.  

---

### **MAC 주소 vs. IP 주소**  

| **특징** | **MAC 주소** | **IP 주소** |
|----------|-------------|-------------|
| **구조** | 평면 구조(Flat) | 계층적 구조(Hierarchical) |
| **변경 여부** | 변하지 않음 (어댑터에 고정) | 네트워크 이동 시 변경됨 |
| **사용 목적** | 동일 네트워크 내 장치 식별 | 네트워크 간 장치 식별 |
| **유사 개념** | 주민등록번호 | 우편 주소 |

- **MAC 주소는 이동해도 변하지 않으며**, 네트워크 내에서 장치를 구별하는 역할을 합니다.  
- **IP 주소는 네트워크 변경 시 새로 할당**되며, 네트워크 간 데이터 전달을 담당합니다.  

---

### **주소 확인 프로토콜(ARP, Address Resolution Protocol)**  

호스트가 데이터를 전송하려면 **목적지 MAC 주소를 알아야 합니다**.  
이를 위해 **ARP(Address Resolution Protocol)**가 사용됩니다.  

#### **ARP의 동작 과정**
1. 송신자가 목적지의 MAC 주소를 모르면, **ARP 요청(브로드캐스트)**을 보냅니다.  
2. 해당 IP 주소를 가진 장치만 **ARP 응답(유니캐스트)**을 보내 자신의 MAC 주소를 전달합니다.  
3. 송신자는 받은 MAC 주소를 ARP 테이블에 저장하고 이후 통신 시 이를 사용합니다.  

#### **ARP 테이블**
- ARP 테이블에는 **IP 주소와 MAC 주소의 매핑 정보**가 저장됩니다.  
- **일정 시간이 지나면 만료되며, 필요할 때 다시 ARP 요청을 수행하여 갱신됩니다.**  

---

## **6.4.2 이더넷(Ethernet)**  

이더넷은 **가장 널리 사용되는 유선 LAN 기술**로, 지속적으로 발전하며 경쟁 기술을 대체해 왔습니다.  

### **이더넷 프레임 구조(Ethernet Frame Structure)**  

이더넷에서 데이터는 **프레임(Frame)**이라는 단위로 전송됩니다.  

| **필드** | **크기** | **설명** |
|----------|---------|---------|
| **프리앰블(Preamble)** | 8바이트 | 프레임 시작을 알리고 수신 클럭을 동기화 |
| **목적지 주소(Destination Address)** | 6바이트 | 프레임을 받을 장치의 MAC 주소 |
| **출발지 주소(Source Address)** | 6바이트 | 프레임을 보낸 장치의 MAC 주소 |
| **타입(Type)** | 2바이트 | 상위 프로토콜(IP, ARP 등) 식별 |
| **데이터(Data)** | 46~1500바이트 | 실제 데이터(IP 데이터그램 등) |
| **순환 중복 검사(CRC)** | 4바이트 | 오류 검출을 위한 체크섬 |

- **MTU(Maximum Transmission Unit)는 1500바이트**이며, 더 큰 데이터그램은 단편화(Fragmentation)가 필요합니다.  
- **최소 46바이트 미만일 경우 패딩(Padding)이 추가됩니다.**  

---

### **링크 계층 스위칭**
링크 계층 스위치는 **브리지(Bridge)의 발전된 형태**로 스위치를 활용하여 네트워크 트래픽을 보다 효율적으로 처리하는 방식입니다. 네트워크 성능을 향상시키기 위해 MAC 주소 기반 포워딩을 수행합니다.   
이전까지의 허브(Hub) 기반 네트워크에서는 네트워크에 연결된 모든 장치가 동일한 충돌 도메인(Collision Domain)에 속해 패킷 충돌이 빈번하게 발생하고, 대역폭이 공유되었습니다. 그러나 스위치(Switch)는 각 포트를 독립적인 충돌 도메인으로 분리하여 이러한 문제를 해결합니다.   

#### **스위치의 주요 기능**
1. **프레임 포워딩 (Frame Forwarding)**  
    - 스위치는 **MAC 주소 테이블(MAC Address Table)**을 유지하며, 이를 기반으로 목적지 MAC 주소가 있는 포트로만 프레임을 전달합니다.   
    - 출발지 MAC 주소를 자동으로 학습(Learning)하여, 목적지 MAC 주소를 기반으로 가장 효율적인 경로로 패킷을 전달합니다.  

2. **루프 방지 (Loop Prevention)**  
    - 네트워크에서 스위치를 여러 개 사용하면 루프(Loop)가 발생할 가능성이 있습니다.
    - 루프가 발생하면 **무한 브로드캐스트 스톰(Broadcast Storm)**이 발생하여 네트워크 성능이 급격히 저하될 수 있습니다.
    - 이를 방지하기 위해 **스패닝 트리 프로토콜(Spanning Tree Protocol, STP)**이 사용되며, 루프가 감지되면 특정 링크를 차단하여 트래픽 폭증을 방지합니다.

#### **스위치 vs. 허브**
| **특징** | **허브(Hub)** | **스위치(Switch)** |
|----------|--------------|--------------------|
| **동작 계층** | 물리 계층(1계층) | 데이터 링크 계층(2계층) |
| **데이터 전송 방식** | 브로드캐스트 (모든 포트로 전달) | MAC 주소 기반 포워딩 |
| **충돌 가능성** | 높음 (CSMA/CD 사용) | 없음 (충돌 도메인 분리) |
| **성능** | 낮음 (공유 대역폭) | 높음 (전이중 통신 지원) |

---

### **대규모 LAN 구축**
대규모 네트워크에서는 수많은 장치가 연결되므로, 단순히 스위치 몇 개를 연결하는 것만으로는 충분하지 않습니다. 더 크고 안정적인 네트워크를 구축하기 위해 네트워크를 계층적으로 설계하는 방식이 사용됩니다.   

1. **계층적 네트워크 설계**
   - **엑세스 계층(Access Layer)**: 사용자 장치가 연결되는 최하위 계층.  
   - **분배 계층(Distribution Layer)**: 여러 엑세스 스위치를 연결하고 정책을 적용.  
   - **코어 계층(Core Layer)**: 네트워크의 백본 역할을 수행하는 고속 스위치.  

2. **가상 LAN(VLAN)**
   - 하나의 물리적 네트워크를 여러 개의 논리적 네트워크로 분할.  
   - **보안성 및 네트워크 효율성 증가**.  

3. **링크 어그리게이션(Link Aggregation)**
   - 여러 개의 물리적 링크를 하나의 논리적 링크처럼 사용하여 대역폭 증가.  

4. **STP(Spanning Tree Protocol) 활용**
   - 루프를 방지하고 네트워크 경로를 최적화.  
